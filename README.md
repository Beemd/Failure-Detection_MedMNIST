# Failure-Detection_MedMNIST
This repository is the official implementation of our article, Failure Detection in Deep Neural Networks for Medical Imaging, under review at Frontiers In Medical Technology.
The proposed failure detection mechanism is based on Bayesian Deep Neural Networks (BDNNs) with Variational Density Propagation (VDP). The VDP_BDNN codes output the decision (mean) and associated uncertainty (variance) simultaneousy. The VDP_BDNN and deterministic models performance can be compared under Gaussian noise and adversarial attacks (PGD, FGSM and CW). The codes in VDP_BDNN_Inference folder can be used to fetch the results for the model performance under noise. This code provides the median output variance for correct, incorrect and combined (correct+incorrect) decisions made by the VDP_BDNN models.
Based on the output variance trends observed under varying types and levels of noise we have proposed two different mechanisms for failure detection, (1) Fixed Threshold and (2) Learned Threshold. These failure detection mechanisms pass all decisions made by the VDP_BDNN models with variance below the threshold and abstain from decisoins which have a confidence level below the threshold (vriance above the threshold). Resultantly, the accuracy of the passed decisions improves. There is a trade-off between the improvement in accuracy of passed decisions and percent decisions abstained.
The fixed threshold mechanism is based on a user defined threshold that can be selected by observing the variance trend under varying Gaussian noise. The VDP_BDNN_Inference codes can be used for getting the results for the fixed threshold mechanism. The threshold values can be modified in the provided code.
The learned threshold mechanism uses a neural network to learn the output variance threshold. The folder Learned_Thresold_models has the models that can be trained to learn the threshold. The dataset to be used in these models can be generated using the models in the folder VDP_BDNN_models.
